//TODO: this code is broken pending the field selection fix.

// all functions are destructive in their arguments
// therefore, they remove those capabilities from the environment
// on calling
let f2 = <t>fun( x : [ e : int , a : ref t :: rw t int , b : [ c : ref t ] ] ).0 in
	let x = { e = 2, a = new new 0 , b = { c = new false } } in
		let y = !(x.a) in
			f2 x;
			!y // cannot be read!
		end
	end
end